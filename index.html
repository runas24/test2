<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Связь с Google Apps Script</title>
</head>
<body>
    <button id="createDocumentButton">Создать документ</button>
    
    <script>
        document.getElementById('createDocumentButton').addEventListener('click', function() {
            var scriptURL = 'https://script.google.com/macros/s/AKfycbx8l5uPCqI-5QzzEp4Y1Rw1c-cOxr-CpksABYujojIRCb5NyTJ5qkux2vWUi84guYi7/exec';
            var templateDocId = '1IUYokH_Gy9BJEDxlOUqmWq15aYH3Oq2TSbOCP0ZeFdQ';

            // Здесь вы можете собрать данные, которые хотите отправить в ваш скрипт
            var requestData = {
                // Например, если у вас есть переменная $result, вы можете её добавить здесь
                result: 'Здесь ваш результат'
            };

            // Отправляем POST-запрос к Google Apps Script
            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors', // Не ждем ответа от сервера
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestData)
            })
            .then(function(response) {
                // Обработка ответа
                console.log('Запрос отправлен успешно');
            })
            .catch(function(error) {
                // Обработка ошибок
                console.error('Произошла ошибка при отправке запроса:', error);
            });
        });
    </script>
</body>
</html>
