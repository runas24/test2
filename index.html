<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Отправка данных в Google Документ</title>
</head>
<body>
<h1>Введите информацию</h1>
<form id="dataForm">
  <label for="data">Информация:</label><br>
  <textarea id="data" name="data" rows="4" cols="50"></textarea><br>
  <input type="submit" value="Отправить">
</form>

<div id="message"></div>

<script>
document.getElementById("dataForm").addEventListener("submit", function(event) {
  event.preventDefault();
  var formData = new FormData(this);
  var data = formData.get("data");
  sendData(data);
});

function sendData(data) {
  var scriptURL = "https://script.google.com/macros/s/AKfycbx8l5uPCqI-5QzzEp4Y1Rw1c-cOxr-CpksABYujojIRCb5NyTJ5qkux2vWUi84guYi7/exec";
  var dataToSend = {data: data};
  
  fetch(scriptURL, {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify(dataToSend)
  })
  .then(function(response) {
    document.getElementById("message").innerText = "Запрос успешно отправлен!";
  })
  .catch(function(error) {
    console.error("Произошла ошибка:", error);
    document.getElementById("message").innerText = "Произошла ошибка при отправке запроса.";
  });
}
</script>
</body>
</html>
